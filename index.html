<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Teste</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='public/css/style.css'>
    <script src="/socket.io/socket.io.js"></script> <!--Pro socket funcionar-->
</head>
<body>
    <h1>Socket.io</h1>
    <form action="" id="form">
        <input type="text" name="" id="message" placeholder="Escreva algo: ">
        <input type="submit" value="Enviar" id="submit">
    </form>
    <ul id="history">
        <!-- Mensagens digitadas aparecerão aqui -->
    </ul>
    <script>
        var socket = io();

        let form = document.getElementById('form')
        let input = document.getElementById('message')
        let history = document.getElementById('history')

        form.addEventListener('submit', (e) =>{
            e.preventDefault(); //Para a página não atualizar ao dar submit
            if(input.value){
                socket.emit('chat message', input.value); 
                input.value = '';
                //Esse 'chat message' serve para nomear essa interação, indicando o que disparar no index.js
            }
        })

        socket.on('chat message', (msg) =>{
            var item = document.createElement('li');
            item.textContent = msg                
            history.appendChild(item)
        })
            //Bloquinho acima capta quando ocorre um chat message, coloca ele em uma li, e mostra ele para TODOS os usuários

        socket.on('user connect', (id) =>{
            var item = document.createElement('li');
            item.textContent = `Usuário ${id} entrou`            
            history.appendChild(item)
        })

        socket.on('user disconnect', (id) =>{
            var item = document.createElement('li');
            item.textContent = `Usuário ${id} saiu`            
            history.appendChild(item)
        })


        

    </script>
    <script src="public/js/nada.js"></script> <!--Teste de node-->
    <script src='server.js'></script> <!--Node-->
    <script>

    </script>
</body>
</html>